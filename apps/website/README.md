# VIOT Platform

ä¸€å€‹åŸºæ–¼ Echo + HTMX + aâ€‘h/templ æ‰“é€ çš„ç¾ä»£åŒ–ç›£æ§ç®¡ç†å¹³å°ã€‚æœ¬å°ˆæ¡ˆæ¡ç”¨å®Œå…¨é…ç½®é©…å‹•çš„é–‹ç™¼æ¨¡å¼ï¼Œå°ˆæ³¨æ–¼é«˜æ•ˆèƒ½ã€é›¢ç·šéƒ¨ç½²èˆ‡æ¨¡çµ„åŒ–è¨­è¨ˆã€‚

## ğŸŒŸ å¹³å°ç‰¹è‰²

- **é…ç½®é©…å‹•**ï¼šæ‰€æœ‰é é¢èˆ‡åŠŸèƒ½çš†ç”± `config/pages.yaml` æ§åˆ¶ï¼Œæ”¯æ´ CRUDã€è…³æœ¬åŸ·è¡Œèˆ‡ Grafana æ•´åˆã€‚
- **äº’å‹•å¼ä»‹é¢**ï¼šæ­é… HTMX å¯¦ç¾ç„¡åˆ·æ–°çš„æŒ‰éˆ•ã€è¡¨å–®ã€å°è©±æ¡†èˆ‡æ¢ä»¶é¡¯ç¤ºã€‚
- **è³‡æ–™ä¾†æºå¤šå…ƒ**ï¼šæ”¯æ´ CSVã€ENVã€YAMLã€LOG ç­‰æ ¼å¼ï¼Œä¸¦å¯åµŒå…¥ Grafana iframeã€‚
- **å…ƒä»¶åŒ– UI**ï¼šä½¿ç”¨ `a-h/templ` æ¶æ§‹ï¼Œä»‹é¢å…ƒä»¶ç¨ç«‹ï¼Œå¯è¤‡ç”¨ã€æ˜“ç¶­è­·ã€‚
- **ç„¡ JS æ¡†æ¶ä¾è³´**ï¼šä»‹é¢äº’å‹•ç´”ç²¹ç”± HTMX æ§åˆ¶ï¼Œç„¡éœ€ Vue æˆ– Reactã€‚
- **å®Œå…¨é›¢ç·šåŒ–**ï¼šæ‰€æœ‰éœæ…‹è³‡æºçš†å·²æœ¬åœ°åŒ–ï¼Œé©ç”¨æ–¼å…§ç¶²èˆ‡å°é–‰ç’°å¢ƒã€‚

## ğŸ” èªè­‰èˆ‡æˆæ¬Š

### ç™»å…¥æ©Ÿåˆ¶
- ä½¿ç”¨ Cookie-based Session èªè­‰
- é è¨­å¸³è™Ÿå¯†ç¢¼ç”±ç’°å¢ƒè®Šæ•¸ `LOGIN_USER` å’Œ `LOGIN_PASS` è¨­å®š
- Session æœ‰æ•ˆæœŸç”± `COOKIE_MAX_AGE` æ§åˆ¶ï¼ˆé è¨­ 7 å¤©ï¼‰
- æ‰€æœ‰é é¢ï¼ˆé™¤ç™»å…¥é å¤–ï¼‰çš†éœ€é©—è­‰

### ç™»å…¥æµç¨‹
1. è¨ªå•ä»»ä½•é é¢æ™‚ï¼Œç³»çµ±æª¢æŸ¥ `session` cookie
2. è‹¥æœªç™»å…¥ï¼Œè‡ªå‹•é‡å°å‘è‡³ `/login` é é¢
3. è¼¸å…¥æ­£ç¢ºå¸³å¯†å¾Œï¼Œè¨­ç½® `session=ok` cookie
4. é‡å°å‘å›åŸæœ¬è¦è¨ªå•çš„é é¢

### ç™»å‡ºæ©Ÿåˆ¶
- é»æ“Šå³ä¸Šè§’ç™»å‡ºæŒ‰éˆ•
- æ¸…é™¤ `session` cookie
- é‡å°å‘è‡³ç™»å…¥é é¢


## ğŸ¨ CSS èˆ‡ Icon ä½¿ç”¨è¦ç¯„

### âœ… CSS æ¨£å¼è¦ç¯„

| é …ç›® | è¦ç¯„èªªæ˜ |
|------|----------|
| æ¡†æ¶ä¾†æº | ä½¿ç”¨ AdminLTE 4.0 Beta3 çš„ç´” CSSï¼Œå·²ä¸‹è¼‰é›¢ç·šç‰ˆ |
| çµ„ä»¶æ¨£å¼ | ä½¿ç”¨ `card`, `badge`, `table`, `form-select-sm`, `btn-outline-*` ç­‰æ¨™æº– class |
| éŸ¿æ‡‰å¼è¨­è¨ˆ | ä¿ç•™ AdminLTE çš„ `container-fluid`, `row`, `col-*` æ¶æ§‹ |
| ç¦ç”¨ JS å‹•æ•ˆ | ä¸ä½¿ç”¨ collapsibleã€modalã€treeview ç­‰éœ€ JS çš„å…ƒä»¶ |

### âœ… Icon åœ–ç¤ºè¦ç¯„

| é …ç›® | è¦ç¯„èªªæ˜ |
|------|----------|
| åœ–ç¤ºä¾†æº | Material Iconsï¼ˆé›¢ç·šå­—é«”åŒ…ï¼‰ |
| ä½¿ç”¨æ–¹å¼ | `<i class="material-icons">icon_name</i>` |
| åœ–ç¤ºé¢¨æ ¼ | é è¨­ä½¿ç”¨ filledï¼Œå¯é¸ outlined/round/sharp/two-tone |
| é¡è‰²æ§åˆ¶ | é€é style æˆ–é¡ä¼¼ tailwind é¡åˆ¥æ§åˆ¶é¡è‰²ï¼ˆå¦‚ `text-muted`, `text-danger`ï¼‰ |
| å¤§å°æ§åˆ¶ | ä½¿ç”¨å…§å»º class `md-18 / md-24 / md-36` æ§åˆ¶å¤§å°ï¼Œä¸å¯« inline CSS |
| å´é‚Šæ¬„é«˜äº® | icon æ­é… `PageConfig.Color`ï¼Œä½œç‚ºé¸å–®åˆ†ç¾¤èˆ‡é«˜äº®ä¾æ“š |

### âœ… AdminLTE 4.0 Beta3 åƒè€ƒæª”æ¡ˆ

#### æ ¸å¿ƒé é¢åƒè€ƒ
| é é¢é¡å‹ | åƒè€ƒæª”æ¡ˆ | èªªæ˜ |
|----------|----------|------|
| ç™»å…¥é é¢ | `docs/adminlte-reference/login-v2.html` | ç™»å…¥è¡¨å–®èˆ‡é©—è­‰ |
| ä¸»æ§å° | `docs/adminlte-reference/index.html` | æ•´é«”å¸ƒå±€èˆ‡å´é‚Šæ¬„ |
| è¡¨æ ¼é é¢ | `docs/adminlte-reference/simple.html` | æ•¸æ“šè¡¨æ ¼èˆ‡åˆ†é  |
| è¡¨å–®é é¢ | `docs/adminlte-reference/general.html` | è¡¨å–®å…ƒç´ èˆ‡é©—è­‰ |
| ç‹€æ…‹é é¢ | `docs/adminlte-reference/general.html` | ç‹€æ…‹é¡¯ç¤ºèˆ‡åœ–ç¤º |

#### çµ„ä»¶åƒè€ƒ
| çµ„ä»¶é¡å‹ | åƒè€ƒæª”æ¡ˆ | èªªæ˜ |
|----------|----------|------|
| å°èˆªæ¬„ | `docs/adminlte-reference/fixed-sidebar.html` | é ‚éƒ¨å°èˆªèˆ‡ç”¨æˆ¶é¸å–® |
| å´é‚Šæ¬„ | `docs/adminlte-reference/sidebar-mini.html` | å´é‚Šæ¬„é¸å–®èˆ‡æŠ˜ç–Š |
| å¡ç‰‡ | `docs/adminlte-reference/cards.html` | å¡ç‰‡å¸ƒå±€èˆ‡æ¨£å¼ |
| è³‡è¨Šå¡ç‰‡ | `docs/adminlte-reference/info-box.html` | è³‡è¨Šå±•ç¤ºå¡ç‰‡ |
| å°å‹å¡ç‰‡ | `docs/adminlte-reference/small-box.html` | çµ±è¨ˆæ•¸æ“šå¡ç‰‡ |
| æŒ‰éˆ• | `docs/adminlte-reference/general.html` | æŒ‰éˆ•æ¨£å¼èˆ‡ç‹€æ…‹ |
| è¡¨æ ¼ | `docs/adminlte-reference/simple.html` | è¡¨æ ¼æ¨£å¼èˆ‡éŸ¿æ‡‰å¼ |
| è¡¨å–® | `docs/adminlte-reference/general.html` | è¡¨å–®å…ƒç´ èˆ‡å¸ƒå±€ |
| å°è©±æ¡† | `docs/adminlte-reference/general.html` | æ¨¡æ…‹æ¡†èˆ‡æç¤º |
| æ¨™ç±¤ | `docs/adminlte-reference/general.html` | æ¨™ç±¤èˆ‡å¾½ç« æ¨£å¼ |

#### è½‰æ›æ³¨æ„äº‹é …
1. **å¸ƒå±€çµæ§‹**
   - ä½¿ç”¨ `wrapper` ä½œç‚ºæœ€å¤–å±¤å®¹å™¨
   - å´é‚Šæ¬„ä½¿ç”¨ `sidebar` é¡åˆ¥
   - ä¸»å…§å®¹å€ä½¿ç”¨ `content-wrapper`

2. **çµ„ä»¶è½‰æ›**
   - å°‡ HTML class è½‰æ›ç‚º templ å±¬æ€§
   - ä½¿ç”¨æ¢ä»¶æ¸²æŸ“æ›¿ä»£ JavaScript å‹•æ…‹æ•ˆæœ
   - ä¿æŒéŸ¿æ‡‰å¼è¨­è¨ˆçš„ class çµæ§‹

3. **äº’å‹•è™•ç†**
   - ä½¿ç”¨ HTMX æ›¿ä»£ JavaScript äº‹ä»¶
   - è¡¨å–®æäº¤ä½¿ç”¨ `hx-post`
   - å‹•æ…‹åŠ è¼‰ä½¿ç”¨ `hx-get`

4. **æ¨£å¼ä¿æŒ**
   - ä¿ç•™ AdminLTE çš„ CSS é¡åˆ¥
   - ä½¿ç”¨ Material Icons æ›¿ä»£ Font Awesome
   - ä¿æŒä¸€è‡´çš„é¡è‰²ä¸»é¡Œ

## ğŸ“ å°ˆæ¡ˆç›®éŒ„

```bash
viot/
â”œâ”€â”€ cmd/                    # ä¸»ç¨‹å¼å…¥å£
â”‚   â””â”€â”€ main.go            # ç¨‹å¼é€²å…¥é»
â”œâ”€â”€ internal/              # å…§éƒ¨å¥—ä»¶
â”‚   â”œâ”€â”€ config/           # é…ç½®ç›¸é—œ
â”‚   â”‚   â”œâ”€â”€ config.go    # é…ç½®çµæ§‹å®šç¾©
â”‚   â”‚   â””â”€â”€ loader.go    # YAML è¼‰å…¥é‚è¼¯
â”‚   â”œâ”€â”€ handler/         # è«‹æ±‚è™•ç†å™¨
â”‚   â”‚   â”œâ”€â”€ auth.go     # èªè­‰ç›¸é—œï¼ˆç™»å…¥/ç™»å‡º/é©—è­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ csv.go      # CSV é é¢è™•ç†
â”‚   â”‚   â”œâ”€â”€ files.go    # æª”æ¡ˆé é¢è™•ç†
â”‚   â”‚   â”œâ”€â”€ exec.go     # å·¥å…·é é¢è™•ç†
â”‚   â”‚   â”œâ”€â”€ log.go      # æ—¥èªŒé é¢è™•ç†
â”‚   â”‚   â””â”€â”€ status.go   # ç‹€æ…‹åœ–è™•ç†
â”‚   â”œâ”€â”€ middleware/      # ä¸­é–“ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.go     # èªè­‰ä¸­é–“ä»¶ï¼ˆSession æª¢æŸ¥ï¼‰
â”‚   â”‚   â””â”€â”€ logger.go   # æ—¥èªŒä¸­é–“ä»¶
â”‚   â”œâ”€â”€ model/          # è³‡æ–™æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ page.go    # é é¢ç›¸é—œçµæ§‹
â”‚   â”‚   â””â”€â”€ user.go    # ä½¿ç”¨è€…ç›¸é—œçµæ§‹
â”‚   â”œâ”€â”€ service/        # æ¥­å‹™é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ auth.go    # èªè­‰é‚è¼¯å¯¦ä½œ
â”‚   â”‚   â”œâ”€â”€ csv.go     # CSV æ“ä½œé‚è¼¯
â”‚   â”‚   â”œâ”€â”€ files.go     # æª”æ¡ˆæ“ä½œé‚è¼¯
â”‚   â”‚   â””â”€â”€ exec.go    # å·¥å…·åŸ·è¡Œé‚è¼¯
â”‚   â””â”€â”€ view/           # Templ å…ƒä»¶
â”‚       â”œâ”€â”€ components/ # å…±ç”¨å…ƒä»¶
â”‚       â”‚   â”œâ”€â”€ layout.templ    # ä¸»å¸ƒå±€
â”‚       â”‚   â”œâ”€â”€ navbar.templ    # å°èˆªæ¬„ï¼ˆå«ç™»å‡ºæŒ‰éˆ•ï¼‰
â”‚       â”‚   â”œâ”€â”€ sidebar.templ   # å´é‚Šæ¬„
â”‚       â”‚   â”œâ”€â”€ table.templ     # è¡¨æ ¼çµ„ä»¶
â”‚       â”‚   â”œâ”€â”€ form.templ      # è¡¨å–®çµ„ä»¶
â”‚       â”‚   â”œâ”€â”€ modal.templ     # å°è©±æ¡†
â”‚       â”‚   â””â”€â”€ status.templ    # ç‹€æ…‹åœ–çµ„ä»¶
â”‚       â””â”€â”€ pages/      # é é¢å…ƒä»¶
â”‚           â”œâ”€â”€ login.templ     # ç™»å…¥é é¢
â”‚           â”œâ”€â”€ csv.templ      # CSV é é¢
â”‚           â”œâ”€â”€ file.templ      # æª”æ¡ˆé é¢
â”‚           â”œâ”€â”€ exec.templ     # å·¥å…·é é¢
â”‚           â”œâ”€â”€ log.templ      # æ—¥èªŒé é¢
â”‚           â””â”€â”€ status.templ   # ç‹€æ…‹åœ–é é¢
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ pages.yaml      # é é¢é…ç½®
â”œâ”€â”€ data/               # æ•¸æ“šæ–‡ä»¶
â”‚   â”œâ”€â”€ .env           # ç’°å¢ƒè®Šé‡ï¼ˆå«ç™»å…¥è¨­å®šï¼‰
â”‚   â”œâ”€â”€ main.log       # ç³»çµ±æ—¥èªŒ
â”‚   â”œâ”€â”€ registry.csv   # è¨­å‚™æ¸…å–®
â”‚   â”œâ”€â”€ scan.csv       # æƒæçµæœ
â”‚   â”œâ”€â”€ status.csv     # è¨­å‚™ç‹€æ…‹
â”‚   â””â”€â”€ tag.csv        # è¨­å‚™æ¨™ç±¤
â”œâ”€â”€ scripts/           # åŸ·è¡Œè…³æœ¬
â”œâ”€â”€ static/           # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ css/         # æ¨£å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ adminlte.min.css
â”‚   â”‚   â”œâ”€â”€ material-icons.css
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ js/          # JavaScript
â”‚   â”‚   â”œâ”€â”€ adminlte.min.js
â”‚   â”‚   â”œâ”€â”€ bootstrap.bundle.min.js
â”‚   â”‚   â””â”€â”€ htmx.min.js
â”‚   â””â”€â”€ fonts/       # å­—é«”æ–‡ä»¶
â”‚       â”œâ”€â”€ NotoSansTC-*.ttf
â”‚       â””â”€â”€ material-icons.*
â”œâ”€â”€ go.mod           # Go æ¨¡çµ„æ–‡ä»¶
â”œâ”€â”€ go.sum           # Go ä¾è³´ç‰ˆæœ¬
â””â”€â”€ README.md        # å°ˆæ¡ˆèªªæ˜
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

1. **å®‰è£ä¾è³´**
   ```bash
   git clone <repository-url>
   cd viot-web
   go mod tidy
   ```

2. **ç’°å¢ƒé…ç½®**

```bash
   # ç™»å…¥é©—è­‰è¨­å®š
   LOGIN_USER=admin
   LOGIN_PASS=admin
   
   # Session ç›¸é—œ
   COOKIE_MAX_AGE=604800
   
   # ç³»çµ±æœå‹™è¨­å®š
   PORT=8080
   LOG_LEVEL=INFO
   GRAFANA_URL=http://localhost:3000
   
   # è¨­å®šæª”è·¯å¾‘
   PAGE_CONFIG_PATH=config/pages.yaml
   
   # ä¸‹æ‹‰é¸å–®
   SET_FACTORY_PHASE=F12:P7,F12:P8,F14:P6     # Factory + Phase çµ„åˆ
   SET_DC_OF_PHASE=F12P7:2,F12P8:1,F14P6:1     # æ¯å€‹ FactoryPhase æœ‰å¹¾å€‹ DC
   SET_ROOM_OF_DC=F12P7DC1:8,F12P7DC2:4,F12P8DC1:1,F14P6DC1:2
   
   # æ¨™ç±¤é¡è‰²é…ç½®
   LEVEL_NORMAL_BACKGROUND_COLOR=#28a745       # æ­£å¸¸ (status_code=0)
   LEVEL_WARN_BACKGROUND_COLOR=#ffc107         # è­¦å‘Š (status_code=1)
   LEVEL_ERROR_BACKGROUND_COLOR=#dc3545        # ç•°å¸¸ (status_code=2)
   
   # PDUå¹³é¢åœ–é¡è‰²é…ç½®
   PDU_EMPTY_BACKGROUND_COLOR=#f8f9fa         # ç©ºæ«ƒåº•è‰² (is_pdu=0)
   PDU_EMPTY_TEXT_COLOR=#6c757d               # ç©ºæ«ƒå­—é«”è‰² (is_pdu=0)
   PDU_DEFAULT_BACKGROUND_COLOR=#dee2e6       # ä¸€èˆ¬åº•è‰² (is_pdu=1)
   PDU_DEFAULT_TEXT_COLOR=#343a40             # ä¸€èˆ¬å­—é«”è‰² (is_pdu=1)
```

3. **ç·¨è­¯é‹è¡Œ**
   ```bash
   # ç”Ÿæˆ templ
   templ generate
   
   # é‹è¡Œæœå‹™
   go run main.go
   ```

## ğŸ§¾ config/pages.yaml æ ¼å¼èˆ‡èªªæ˜

æ¯å€‹é é¢çš†ç”±ä¸€ç­† `PageConfig` çµ„æˆï¼Œæ”¯æ´ä»¥ä¸‹æ¬„ä½ï¼š

### é é¢å…±ç”¨æ¬„ä½å®šç¾©
| æ¬„ä½           | é¡å‹         | èªªæ˜                                 |
|----------------|--------------|--------------------------------------|
| name           | string       | è·¯ç”±èˆ‡è­˜åˆ¥åç¨±ï¼ˆå”¯ä¸€ï¼‰              |
| label          | string       | å·¦å´é¸å–®èˆ‡é é¢æ¨™é¡Œé¡¯ç¤º               |
| icon           | string       | Material Icons åœ–ç¤ºåç¨±              |
| color          | string       | icon æ–‡å­—é¡è‰²ï¼ˆå¦‚ text-primaryï¼‰     |
| type           | string       | é é¢é¡å‹ï¼ˆcsv/files/log/status/exec/panels/dashboardï¼‰ |
| path           | string       | å°æ‡‰è³‡æ–™ä¾†æºï¼ˆCSV è·¯å¾‘æˆ– logï¼‰ |
| fields         | []Field      | æ¬„ä½æ¸…å–®ï¼ˆé©ç”¨æ–¼ csv/statusï¼‰   |
| actions        | []Action     | å·¥å…·æŒ‰éˆ•å®šç¾©ï¼ˆåƒ… type=execï¼‰         |
| url            | string       | åµŒå…¥é¢æ¿ç¶²å€ï¼ˆåƒ… type=dashboardï¼‰    |
| panels         | []Panel      | å¤šé¢æ¿åµŒå…¥ï¼ˆåƒ… type=panelsï¼‰         |
| layout         | Layout       | panels é¡å‹æ™‚æ§åˆ¶ Grid ä½ˆå±€         |

### Field æ¬„ä½æ ¼å¼ï¼ˆfields[]ï¼‰
| æ¬„ä½         | é¡å‹     | èªªæ˜                            |
|--------------|----------|---------------------------------|
| name         | string   | æ¬„ä½åç¨±ï¼ˆå°æ‡‰è³‡æ–™ä¾†æºæ¬„ä½ï¼‰     |
| label        | string   | é¡¯ç¤ºç”¨ä¸­æ–‡æ¬„ä½å                 |
| type         | string   | å¯ç‚º text/hiddenï¼ˆé¸å¡«ï¼‰         |
| readonly     | bool     | æ˜¯å¦å”¯è®€                         |
| enum         | []string | ä¸‹æ‹‰é¸å–®é¸é …ï¼ˆå¦‚ [true, false]ï¼‰ |

### Action æ¬„ä½æ ¼å¼ï¼ˆactions[]ï¼Œåƒ… type=execï¼‰
| æ¬„ä½         | èªªæ˜                            |
|--------------|---------------------------------|
| label        | é¡¯ç¤ºçš„æŒ‰éˆ•åç¨±                  |
| script_path  | è¦åŸ·è¡Œçš„ shell æŒ‡ä»¤è·¯å¾‘         |
| icon         | Material Icons åœ–ç¤º             |
| desc         | æè¿°èªªæ˜ï¼ˆé¡¯ç¤ºæ–¼ hoverï¼‰         |
| type         | `exec` æˆ– `download`             |
| disabled     | æ˜¯å¦ç¦ç”¨è©²åŠŸèƒ½                   |

### Panel èˆ‡ Layout æ ¼å¼ï¼ˆåƒ… type=panelsï¼‰
```yaml
layout:
  type: grid
  columns: 2
  gap: 16
panels:
  - title: PDU å³æ™‚ç‹€æ…‹
    url: http://...
    position:
      row: 1
      col: 1
      colSpan: 2
      rowSpan: 1
```

## ğŸ“‹ é é¢åŠŸèƒ½èªªæ˜

### 1. ç™»å…¥é é¢ï¼ˆtype: loginï¼‰
- ä½¿ç”¨ `login.templ` å‘ˆç¾ç™»å…¥ç•«é¢ï¼Œæ”¯æ´ HTMX è¡¨å–®é€å‡ºèˆ‡éŒ¯èª¤å›é¥‹ã€‚ 
- ç™»å…¥é é¢æ˜¯å”¯ä¸€å…è¨±æœªç™»å…¥å­˜å–çš„é é¢ã€‚
- æ”¯æ´ HTMX è¡¨å–®æäº¤ï¼Œé¿å…é é¢åˆ·æ–°
- éŒ¯èª¤è¨Šæ¯å³æ™‚é¡¯ç¤ºï¼Œæå‡ä½¿ç”¨è€…é«”é©—
- ç™»å…¥æˆåŠŸå¾Œè‡ªå‹•é‡å°å‘è‡³åŸè«‹æ±‚é é¢
- æ•´åˆ AdminLTE ç™»å…¥é é¢æ¨£å¼
- æ‰€æœ‰è«‹æ±‚çš†é€šé `auth` ä¸­é–“ä»¶é©—è­‰
- ç™»å…¥ç‹€æ…‹ç”± `session` cookie æ§åˆ¶
- ç™»å…¥å¤±æ•—æ™‚è¨˜éŒ„éŒ¯èª¤æ—¥èªŒ
- æ”¯æ´è¨˜ä½ç™»å…¥ç‹€æ…‹ï¼ˆç”± `COOKIE_MAX_AGE` æ§åˆ¶ï¼‰
- ç™»å‡ºæ™‚æ¸…é™¤æ‰€æœ‰ç›¸é—œ cookie

### 2. PDU ç‹€æ…‹åœ–é ï¼ˆtype: statusï¼‰
- æ ¹æ“š `row`, `col`, `room` ç­‰æ¬„ä½å‘ˆç¾ PDU åˆ†å¸ƒåœ–æ ¼ç‹€æ’åˆ—ã€‚
- è©²é é¢æ”¯æ´è¨­å‚™é›™é‚Šï¼ˆL/Rï¼‰æ’ç‰ˆèˆ‡ Grid è³‡æ–™æ ¼çµ„åˆé‚è¼¯ã€‚
- é»æ“Šä»»ä¸€ PDU å°‡ä»¥ modal é¡¯ç¤ºè©³ç´°è³‡è¨Šèˆ‡å°æ‡‰æ¬„ä½å…§å®¹ã€‚
- ç¯©é¸æ”¯æ´ï¼šå» (factory), å€(phase), è³‡æ–™ä¸­å¿ƒ(dc), æˆ¿é–“(room)ã€‚
- ä½¿ç”¨ `status.csv` ç‚ºä¾†æºï¼Œæ”¯æ´æ¬„ä½åŒ…å« ip,factory,phase,dc,room,row,col,side,is_pdu,name,has_data,protocol_status,status_code,enabled,message
- å°‡å·¦/å³å´ PDUï¼ˆL/Rï¼‰åˆä½µç‚º `Grid[row][col] = {Left, Right}` çµæ§‹
- æ”¯æ´ `status_code = 0/1/2` ï¼ˆç”± env æ§åˆ¶é¡è‰²ï¼‰
- æœƒè¨ˆç®—ç•°å¸¸ç™¾åˆ†æ¯” `abnormalPercent = ç´…æ ¼ / ç¸½æ ¼æ•¸` ä¸¦é¡¯ç¤ºæ–¼ç•«é¢


```bash
   # æ¨™ç±¤é¡è‰²é…ç½®
   LEVEL_NORMAL_BACKGROUND_COLOR=#28a745       # æ­£å¸¸
   LEVEL_WARN_BACKGROUND_COLOR=#ffc107         # è­¦å‘Š
   LEVEL_ERROR_BACKGROUND_COLOR=#dc3545        # ç•°å¸¸
   LEVEL_DEBUG_BACKGROUND_COLOR=#198754        # ç¶­è­·
```

- `is_pdu=0` é¡¯ç¤ºç‚ºç©ºæ ¼ï¼ˆéè¨­å‚™æ ¼ï¼‰
```bash
   # PDUå¹³é¢åœ–é¡è‰²é…ç½®
   PDU_EMPTY_BACKGROUND_COLOR=#f8f9fa         # ç©ºæ«ƒåº•è‰² (is_pdu=0)
   PDU_EMPTY_TEXT_COLOR=#6c757d               # ç©ºæ«ƒå­—é«”è‰² (is_pdu=0)
   PDU_DEFAULT_BACKGROUND_COLOR=#dee2e6       # ä¸€èˆ¬åº•è‰² (is_pdu=1)
   PDU_DEFAULT_TEXT_COLOR=#343a40             # ä¸€èˆ¬å­—é«”è‰² (is_pdu=1)
```
- å¯è®€å– `has_data`, `protocol_status`, `enabled`, `message` ä½œç‚ºè©³ç´°è¨Šæ¯ï¼ˆæœªä¾†å¯ç¶å®š tooltip æˆ– modalï¼‰
- Grid æ’åºæœƒå°‡ `AA` æ’åœ¨æœ€æœ«ï¼›col æœƒè½‰ int æ’åºï¼ˆé¿å…å­—ä¸²æ’åºéŒ¯ä½ï¼‰



### 3.CSV é¡å‹ CRUD
- æª”æ¡ˆè·¯å¾‘ç”± `page.Path` æŒ‡å®šã€‚
- æ”¯æ´ `create`, `edit`, `update`, `delete` å„é …æ“ä½œã€‚
- æ¯ä¸€åˆ—è½‰æ›ç‚º `Row{ID, Fields}` ä¸¦æ¸²æŸ“ã€‚
- å¦‚æœ‰æ¬„ä½ `interval`, `template_version` ç­‰ï¼Œä¹Ÿå°‡è½‰æ›ç‚ºä¸‹æ‹‰ã€æ—¥æœŸç­‰å°æ‡‰æ¬„ä½å‹æ…‹ã€‚
- å¯è¨­å®š `Upload: true` å…è¨±ä¸Šå‚³ CSV æª”æ¡ˆï¼Œå‰¯æª”åéœ€ç‚º `.csv`ã€‚
- æ¯æ¬¡ä¿®æ”¹æˆ–æ–°å¢ç´€éŒ„æ™‚çš†æœƒè‡ªå‹•è£œä¸Š timestamp æ¬„ä½ã€‚
- è‹¥æœ‰æ¬„ä½åç‚º `create_at`, `update_at` å‰‡ç³»çµ±è‡ªå‹•å¡«å…¥æ™‚é–“æˆ³ã€‚

### 4. æ–‡ä»¶è¨­å®šé ï¼ˆtype: filesï¼‰
- å¯æ“ä½œ `.env`, `.yaml`, `.txt` ç­‰å¸¸è¦‹è¨­å®šæª”æ¡ˆã€‚
- æ¯ç­†æª”æ¡ˆæœƒæ¸²æŸ“ç‚ºä¸€é¡†æŒ‰éˆ•ï¼ŒæŒ‰ä¸‹å¾Œæœƒé¡¯ç¤ºå…¨æ–‡å…§å®¹ã€‚
- é»é¸å¾Œç‚ºå…¨æ–‡æ¨¡å¼ï¼Œæ”¯æ´é¡¯ç¤ºè¡Œæ•¸èˆ‡å¿«é€Ÿæœå°‹ï¼ˆæœªä¾†å¯æ“´å……ï¼‰ã€‚
- `type: view`ï¼šå”¯è®€æª¢è¦–ï¼Œç„¡æ³•ç·¨è¼¯ã€‚
- `type: edit`ï¼šå¯é€²å…¥ç·¨è¼¯ç•«é¢ä¿®æ”¹å…§å®¹ã€‚
- å°‡åŸå§‹æª”æ¡ˆé‡æ–°å‘½åç‚º `xxx.20250421-173012.bak` å‚™ä»½ã€‚
- è¦†å¯«è©²æª”æ¡ˆå…§å®¹ç‚ºä½¿ç”¨è€…æœ€æ–°å„²å­˜å…§å®¹ã€‚
- ç›®å‰æ”¯æ´å‰¯æª”åï¼š`.env`, `.yaml`, `.yml`, `.txt`ã€‚

### 5. å·¥å…·æ“ä½œé ï¼ˆtype: execï¼‰
- æ¯å€‹ Action å°æ‡‰ä¸€æ®µ bash scriptã€‚
- æ¯é¡†æŒ‰éˆ•çš†å°æ‡‰ä¸€æ”¯å¯¦é«” shell scriptï¼Œå¯é€éç’°å¢ƒè®Šæ•¸æ§åˆ¶ç¦ç”¨æˆ–åˆ‡æ›åŸ·è¡Œæ¬Šé™ã€‚
- ä½¿ç”¨è€…é»é¸æŒ‰éˆ•è§¸ç™¼å¾Œç«¯åŸ·è¡ŒæŒ‡ä»¤ï¼Œçµæœå›å‚³é¡¯ç¤ºæ–¼ modal æˆ–é é¢ä¸­ã€‚
- çµæ§‹ä¾†æºç‚º `Actions[]`ï¼š`label`, `type`, `script_path`ã€‚
- `actions[]` å®šç¾©åŸ·è¡Œé …ç›®ï¼Œæ¯é …åŒ…å« labelã€pathã€type(exec/download)ã€disabledã€‚
- `/exec/run` å¯¦éš›åŸ·è¡Œ bash æŒ‡ä»¤ï¼Œå›å‚³åŸ·è¡Œè¼¸å‡ºï¼ˆéœ€å…è¨± server shellï¼‰ã€‚
- `/exec/download?path=xxx` é™å®šåƒ…èƒ½ä¸‹è¼‰ `data/` æˆ– `scripts/` ç›®éŒ„å…§æª”æ¡ˆã€‚

### 6. ç³»çµ±æ—¥èªŒé ï¼ˆtype: logï¼‰
- è®€å– `main.log` æˆ–æŒ‡å®šè·¯å¾‘ï¼Œtail æœ€æœ« n è¡Œé¡¯ç¤ºã€‚
- æ¯è¡Œè‡ªå‹•è§£æ `log level`ï¼šINFO / DEBUG / WARN / ERRORã€‚
- æ”¯æ´å¤šç´šç¯©é¸èˆ‡é›™å‘æ»‘å‹•ï¼Œé©ç”¨æ–¼å¤§å‹éƒ¨ç½²æ™‚å¿«é€Ÿæ’æŸ¥ã€‚
- ä¸åŒç­‰ç´šæ¨™ç¤ºä¸åŒé¡è‰²ï¼šINFO, DEBUG, WARN, ERRORã€‚

```bash
   # æ¨™ç±¤é¡è‰²é…ç½®
   LEVEL_NORMAL_BACKGROUND_COLOR=#28a745       # æ­£å¸¸
   LEVEL_WARN_BACKGROUND_COLOR=#ffc107         # è­¦å‘Š
   LEVEL_ERROR_BACKGROUND_COLOR=#dc3545        # ç•°å¸¸
   LEVEL_DEBUG_BACKGROUND_COLOR=#198754        # ç¶­è­·
```
- æ”¯æ´ log è¨Šæ¯å¤šè¡ŒæŠ˜ç–Šé¡¯ç¤ºèˆ‡èªæ„è‘—è‰²ï¼ˆæœªä¾†æ“´å……ï¼‰ã€‚
- æ”¯æ´å¿«é€Ÿåˆ‡æ›æ’åºï¼š`top`ï¼ˆæœ€æ–°åœ¨ä¸Šï¼‰/ `tail`ï¼ˆæœ€æ–°åœ¨ä¸‹ï¼‰ã€‚
- å¯æœªä¾†æ“´å…… filter é—œéµå­—ã€è¤‡è£½ç­‰åŠŸèƒ½ã€‚
- æ”¯æ´ btn-group å¤šé¸åˆ‡æ›ï¼ˆINFO / DEBUG / WARN / ERRORï¼‰ä»¥ç¯©é¸æ¬²æŸ¥çœ‹çš„ç­‰ç´šã€‚
- æä¾›æ‡¸æµ®æŒ‰éˆ•å¿«é€Ÿæ»‘å‹•è‡³æœ€ä¸Šï¼æœ€ä¸‹ï¼Œæ–¹ä¾¿æª¢è¦–å¤§é‡æ—¥èªŒã€‚
- å¯æ ¹æ“š pages.yaml ä¸­çš„ `level: DEBUG` æ§åˆ¶æœ€ä½é¡¯ç¤ºç­‰ç´šã€‚
- æ¯è¡Œ log è‡ªå‹•è§£æ `[LEVEL]` ä¸¦åŠ ä¸Šé¡è‰² classï¼ˆç”± template åˆ¤æ–·ï¼‰ã€‚
- å°šä¸æ”¯æ´é é¢æœå°‹èˆ‡åˆ‡æ›æ’åºï¼Œä½†ä¿ç•™ future æ“´å……ç©ºé–“ã€‚

### 7. Grafana å–®ä¸€é¢æ¿ï¼ˆtype: dashboardï¼‰
- ä½¿ç”¨ `page.URL` ä½œç‚º iframe srcï¼Œå…§åµŒå®Œæ•´ Grafana å„€è¡¨æ¿é é¢
- é€šå¸¸ç‚º `/d/xxxxx?orgId=1&panelId=1&kiosk` é¡é€£çµ
- ä½¿ç”¨ `iframe.templ` æˆ–ç°¡åŒ–ç‰ˆé¢å‘ˆç¾

### 8. Grafana å¤šé¢æ¿ï¼ˆtype: panelsï¼‰
- ä½¿ç”¨ `page.Panels[]` é™£åˆ—æŒ‡å®šå¤šå€‹é¢æ¿æ¨™é¡Œèˆ‡ URL
- å¯æ­é… `Layout.Columns` æ§åˆ¶é¢æ¿æ’åˆ—ï¼ˆGridï¼‰
- é€é `panel_grid.templ` å‹•æ…‹ç”¢å‡º iframe å€å¡Š


---

> æœ¬é …ç›®ä¸ä¾è³´ AdminLTE JavaScriptï¼Œç´”ç²¹ä½¿ç”¨å…¶ CSS æ¨£å¼ã€‚æ‰€æœ‰äº’å‹•å‡é€šé HTMX å¯¦ç¾ã€‚
> å°ˆæ¡ˆå·²å®Œæ•´ä¸‹è¼‰æ‰€æœ‰å¿…è¦çš„ CSSã€å­—å‹èˆ‡ JS æª”æ¡ˆï¼Œç¢ºä¿å¯åœ¨é›¢ç·šç’°å¢ƒéƒ¨ç½²ã€‚
